<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    <script defer language="javascript" type="text/javascript" src="/js/light_dark.js"></script>
<script defer language="javascript" type="text/javascript" src="/js/tabs.js"></script>


<script defer language="javascript" type="text/javascript" src="/js/katex.min.js"></script>


<script defer language="javascript" type="text/javascript" src="/js/auto-render.min.js"></script>


<script defer language="javascript" type="text/javascript" src="/js/katex.js"></script>
<script defer language="javascript" type="text/javascript" src="/js/toc.js"></script>


    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="generator" content="Hugo 0.110.0">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Subdomain enumeration is cool , How about domain enumeration ? Part II &middot; youssef lahouifi</title>
    <meta name="description" content="" />

    
    <link type="text/css" rel="stylesheet" href="/css/poole.css">
<link type="text/css" rel="stylesheet" href="/css/syntax.css">
<link type="text/css" rel="stylesheet" href="/css/hyde.css">
<link type="text/css" rel="stylesheet" href="/css/poison.css">
<link type="text/css" rel="stylesheet" href="/css/fonts.css">
<link type="text/css" rel="stylesheet" href="/css/katex.min.css">
<link type="text/css" rel="stylesheet" href="/css/tabs.css">


    
    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #303030;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5a5a5a;
        --link-color: #268bd2;
        --date-color: #515151;
        --code-color: #bf616a;
        --code-background-color: #f9f9f9;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #eee;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9d9d9d;
        --link-color: #268bd2;
        --date-color: #9a9a9a;
        --code-color: #ff7f7f;
        --code-background-color: #393D47;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="/">
                <img src="/images/me2.jpg" alt="brand image">
            </a>
        
        
            <a href="/">
                <h1>Youssef Lahouifi</h1>
            </a>
        
    </h1>
    <p class="lead">
    
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">
        
        
        
        
            
                
                    <li class="heading">
                        <a href="/about/">About</a>
                    </li>
                    
                
            
                
            
        
        
            
                
            
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="/posts/domain-enumeration-2/">Subdomain enumeration is cool , How about domain enumeration ? Part II</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="/posts/domain-enumeration/">Subdomain enumeration is cool , How about domain enumeration ? Part I</a>
                            </li>
                        
                    
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" href="https://github.com/yousseflahouifi">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>


    <a target="_blank" class="social" href="https://linkedin.com/in/youssefla/">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9V416z"/>
        </svg>
    </a>


    <a target="_blank" class="social" href="https://twitter.com/YLahouifi">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M5.032 14.286c6.037 0 9.34-4.837 9.34-9.032c0-.137 0-.274-.01-.41A6.56 6.56 0 0 0 16 3.2c-.6.256-1.235.425-1.885.5a3.207 3.207 0 0 0 1.443-1.757c-.645.37-1.35.63-2.085.77a3.322 3.322 0 0 0-1.862-.958a3.384 3.384 0 0 0-2.082.334a3.223 3.223 0 0 0-1.442 1.49a3.08 3.08 0 0 0-.208 2.03a9.57 9.57 0 0 1-3.747-.963a9.269 9.269 0 0 1-3.018-2.354a3.086 3.086 0 0 0-.36 2.314c.189.787.68 1.475 1.376 1.924a3.344 3.344 0 0 1-1.49-.398v.04c0 .734.263 1.444.743 2.01a3.3 3.3 0 0 0 1.89 1.102c-.483.128-.99.146-1.482.055a3.19 3.19 0 0 0 1.168 1.577a3.36 3.36 0 0 0 1.9.627A6.732 6.732 0 0 1 0 12.86a9.527 9.527 0 0 0 5.032 1.423"/>
        </svg>
    </a>








        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2023 youssef lahouifi. All rights reserved.
</p>

  </div>
</aside>

        <main class="content container">
            <div class="post">
  <div class="info">
    <h1 class="post-title">
        <a href="/posts/domain-enumeration-2/">Subdomain enumeration is cool , How about domain enumeration ? Part II</a>
    </h1>
    <time datetime="2023-01-27T00:00:00Z" class="post-date">
        January 27, 2023
    </time>
    
    <ul class="tags">
        
        <li class="tag-bugbounty">
            <a href="/tags/bugbounty">bugbounty</a>
        </li>
        
        <li class="tag-reconnaissance">
            <a href="/tags/reconnaissance">reconnaissance</a>
        </li>
        
        <li class="tag-pentest">
            <a href="/tags/pentest">pentest</a>
        </li>
        
        <li class="tag-">
            <a href="/tags/"></a>
        </li>
        
    </ul>
    
    
    
    
    
    
</div>

  <h2 id="introduction">Introduction</h2>
<p>In the previous part of this blog, we delved into the world of domain enumeration and discussed various techniques used to find domains associated with an organization. We explored methods such as shared DNS, reverse IP lookup, MX record reverse lookup, and finding ASN which can help to uncover related domain names to an organization.</p>
<p>In this part of the blog post we will see how leveraging certificate transparency can help us discover even more domains belonging to an organization We will examine the power of this technique along with tools used to uncover more related domains.</p>
<h2 id="finding-domaines-and-ips-sharing-organization-field-in-ssl-certificate">Finding Domaines And IPs Sharing Organization Field In SSL Certificate</h2>
<p>One strategy I often employ in my domain enumeration process is to look for commonalities in SSL certificates across multiple domains. One key piece of information to look for is the Organization field, which can provide clues about the ownership of multiple domains. For example a certificate from <a href="https://maktoob.yahoo.com/">https://maktoob.yahoo.com/</a> and <a href="https://www.kol.com/">https://www.kol.com/</a> are sharing the same organization field in the ssl cerificate which is &ldquo;Oath Holdings Inc&rdquo;.</p>
<p><img src="/images/11.png" alt="kol ssl">
<img src="/images/12.png" alt="yahoo ssl"></p>
<p>To find other domains belonging to the same entity you can use the famous <a href="https://crt.sh/">crt.sh</a> by requesting the url :</p>





<div class="tabs-container">
    <div class="tabs" role="tablist">

	    
        
            
            <button class="tab active" id="fadebc">
            

                using crt.sh
            </button>

	    

    </div>

    
    
        
            <div class="tabcontent fadebc" style="display:block;">
        

        
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>https://crt.sh/?O=Oath%20Holdings%20Inc</span></span></code></pre></div>

        
        
    </div>
    
</div>

<p><img src="/images/13.png" alt="crt.sh"></p>
<p>Or by using <a href="https://gist.github.com/yousseflahouifi/e58f19a1e1476b78a355986b2a5ae122">this</a> oneliner.</p>
<p>Or you can use the certificate option in censys using the following filter:</p>





<div class="tabs-container">
    <div class="tabs" role="tablist">

	    
        
            
            <button class="tab active" id="afbdce">
            

                Using censys
            </button>

	    

    </div>

    
    
        
            <div class="tabcontent afbdce" style="display:block;">
        

        
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>parsed.subject.organization:&#34;Oath Holdings Inc.&#34; </span></span></code></pre></div>

        
        
    </div>
    
</div>

<p><img src="/images/14.png" alt="censys"></p>
<p>You can also use censys host option to find IPs adresses with the same organization field using the following filer :</p>





<div class="tabs-container">
    <div class="tabs" role="tablist">

	    
        
            
            <button class="tab active" id="febdac">
            

                Using censys
            </button>

	    

    </div>

    
    
        
            <div class="tabcontent febdac" style="display:block;">
        

        
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>services.tls.certificates.leaf_data.subject.organization:&#34;Oath Holdings Inc.&#34;</span></span></code></pre></div>

        
        
    </div>
    
</div>

<p><img src="/images/15.png" alt="censys"></p>
<p>If you are interested in automating stuff i have made a tool called <a href="https://github.com/yousseflahouifi/censorg">censorg</a> , it basically takes the organization field as input and it shows IPs and other domains sharing the organization field.</p>
<p><img src="/images/16.png" alt="censorg"></p>
<p>I have also made another <a href="https://github.com/yousseflahouifi/orgot">simple tool</a> called orgot in bash scripting which takes a list of working http and https servers and it will get you the organization fields in the ssl certificates.</p>
<p>It&rsquo;s important to note that in some cases, different subdomains may have different Organization names attached to their SSL certificates. By searching based on these Organization names, you can uncover additional domains that are related to the same entity .</p>
<p>So a possible workflow might be something like this :</p>
<p><img src="/images/17.png" alt="orgot.sh"></p>
<h2 id="conclusion">Conclusion</h2>
<p>In conclusion, leveraging certificate transparency can be a powerful technique for identifying additional domains belonging to an organization. By looking for commonalities in SSL certificates such as shared Organization fields, you can uncover valuable domaines and IPs which will increase your chance of finding a bug .</p>

  <hr>
<div class="footer">
    
	    
            
	            <a class="previous-post" href="/posts/domain-enumeration/?ref=footer">« Subdomain enumeration is cool , How about domain...</a>
	        
        
	    
    
</div>

  <div class="article-toc " >
    <h4></h4>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#finding-domaines-and-ips-sharing-organization-field-in-ssl-certificate">Finding Domaines And IPs Sharing Organization Field In SSL Certificate</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
</div>

</div>
        </main>
    </body>
</html>
